function [r_B, r_Bx, r_By, r_Bz, r_G, r_Gx, r_Gy, r_Gz, p1, p2, p3, p4, p5, p6, p7, p8] = draw_fb(t,z,xG,yG,zG,lCuboid, wCuboid, hCuboid)   

q1 = z(1);   u1 = z(2);
q2 = z(3);   u2 = z(4);
q3 = z(5);   u3 = z(6);
q4 = z(7);   u4 = z(8);
q5 = z(9);   u5 = z(10);
q6 = z(11);   u6 = z(12);
p1(1,1) = q1 + (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 - (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p1(2,1) = q2 - (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 + (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p1(3,1) = q3 - (lCuboid*sin(q5))/2 - xG*sin(q5) + (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) + (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
p2(1,1) = q1 + (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 - (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) - (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p2(2,1) = q2 - (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 + (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) - (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p2(3,1) = q3 + (lCuboid*sin(q5))/2 - xG*sin(q5) + (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) + (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
p3(1,1) = q1 + (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 + (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) - (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p3(2,1) = q2 - (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 - (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) - (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p3(3,1) = q3 + (lCuboid*sin(q5))/2 - xG*sin(q5) + (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) - (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
p4(1,1) = q1 + (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 + (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p4(2,1) = q2 - (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 - (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p4(3,1) = q3 - (lCuboid*sin(q5))/2 - xG*sin(q5) + (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) - (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
p5(1,1) = q1 - (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 - (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p5(2,1) = q2 + (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 + (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p5(3,1) = q3 - (lCuboid*sin(q5))/2 - xG*sin(q5) - (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) + (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
p6(1,1) = q1 - (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 - (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) - (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p6(2,1) = q2 + (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 + (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) - (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p6(3,1) = q3 + (lCuboid*sin(q5))/2 - xG*sin(q5) - (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) + (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
p7(1,1) = q1 - (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 + (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) - (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p7(2,1) = q2 + (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 - (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) - (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p7(3,1) = q3 + (lCuboid*sin(q5))/2 - xG*sin(q5) - (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) - (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
p8(1,1) = q1 - (hCuboid*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)))/2 + (wCuboid*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)))/2 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + (lCuboid*cos(q5)*cos(q6))/2 + xG*cos(q5)*cos(q6);
p8(2,1) = q2 + (hCuboid*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)))/2 - (wCuboid*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)))/2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + (lCuboid*cos(q5)*sin(q6))/2 + xG*cos(q5)*sin(q6);
p8(3,1) = q3 - (lCuboid*sin(q5))/2 - xG*sin(q5) - (hCuboid*cos(q4)*cos(q5))/2 + zG*cos(q4)*cos(q5) - (wCuboid*cos(q5)*sin(q4))/2 + yG*cos(q5)*sin(q4);
r_Bx(1,1) = q1 + cos(q5)*cos(q6);
r_Bx(2,1) = q2 + cos(q5)*sin(q6);
r_Bx(3,1) = q3 - sin(q5);
r_By(1,1) = q1 - cos(q4)*sin(q6) + cos(q6)*sin(q4)*sin(q5);
r_By(2,1) = q2 + cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6);
r_By(3,1) = q3 + cos(q5)*sin(q4);
r_Bz(1,1) = q1 + sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5);
r_Bz(2,1) = q2 - cos(q6)*sin(q4) + cos(q4)*sin(q5)*sin(q6);
r_Bz(3,1) = q3 + cos(q4)*cos(q5);
r_B(1,1) = q1;
r_B(2,1) = q2;
r_B(3,1) = q3;
r_G(1,1) = q1 - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + xG*cos(q5)*cos(q6);
r_G(2,1) = q2 + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + xG*cos(q5)*sin(q6);
r_G(3,1) = q3 - xG*sin(q5) + zG*cos(q4)*cos(q5) + yG*cos(q5)*sin(q4);
r_Gx(1,1) = q1 + cos(q5)*cos(q6) - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + xG*cos(q5)*cos(q6);
r_Gx(2,1) = q2 + cos(q5)*sin(q6) + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + xG*cos(q5)*sin(q6);
r_Gx(3,1) = q3 - sin(q5) - xG*sin(q5) + zG*cos(q4)*cos(q5) + yG*cos(q5)*sin(q4);
r_Gy(1,1) = q1 - cos(q4)*sin(q6) - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + xG*cos(q5)*cos(q6) + cos(q6)*sin(q4)*sin(q5);
r_Gy(2,1) = q2 + cos(q4)*cos(q6) + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + sin(q4)*sin(q5)*sin(q6) + xG*cos(q5)*sin(q6);
r_Gy(3,1) = q3 + cos(q5)*sin(q4) - xG*sin(q5) + zG*cos(q4)*cos(q5) + yG*cos(q5)*sin(q4);
r_Gz(1,1) = q1 + sin(q4)*sin(q6) - yG*(cos(q4)*sin(q6) - cos(q6)*sin(q4)*sin(q5)) + zG*(sin(q4)*sin(q6) + cos(q4)*cos(q6)*sin(q5)) + xG*cos(q5)*cos(q6) + cos(q4)*cos(q6)*sin(q5);
r_Gz(2,1) = q2 - cos(q6)*sin(q4) + yG*(cos(q4)*cos(q6) + sin(q4)*sin(q5)*sin(q6)) - zG*(cos(q6)*sin(q4) - cos(q4)*sin(q5)*sin(q6)) + xG*cos(q5)*sin(q6) + cos(q4)*sin(q5)*sin(q6);
r_Gz(3,1) = q3 + cos(q4)*cos(q5) - xG*sin(q5) + zG*cos(q4)*cos(q5) + yG*cos(q5)*sin(q4);
